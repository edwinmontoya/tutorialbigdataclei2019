{"paragraphs":[{"text":"// wordcount en scala\nval linesDF = sc.textFile(\"s3://emontoyapublic/datasets/gutenberg-small/\").toDF(\"line\")\nval wordsDF = linesDF.explode(\"line\",\"word\")((line: String) => line.split(\" \"))\nval wordCountDF = wordsDF.groupBy(\"word\").count()\n// cualquiera de las 2 siguientes formas:\n//wordCountDF.orderBy($\"count\".desc).show(10)\nwordCountDF.sort($\"count\".desc).show(10)","user":"anonymous","dateUpdated":"2019-10-04T14:37:06+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-10-0-0-75.us-east-2.compute.internal:4040/jobs/job?id=0"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1570199688358_-264926735","id":"20191003-232735_1630836940","dateCreated":"2019-10-04T14:34:48+0000","dateStarted":"2019-10-04T14:37:06+0000","dateFinished":"2019-10-04T14:37:48+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:13373"},{"text":"%pyspark\ninput_file = sc.textFile(\"s3://emontoyapublic/datasets/gutenberg-small/\")\nmap = input_file.flatMap(lambda line: line.split(\" \")).map(lambda word: (word, 1))\ncounts = map.reduceByKey(lambda a, b: a + b)\noutput = counts.sortBy(lambda a: -a[1])\nfor (w, c) in output.take(10):\n        print (w, c)\noutput.coalesce(1).saveAsTextFile(\"/tmp/salida1\")\n\n","user":"anonymous","dateUpdated":"2019-10-04T14:38:12+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-10-0-0-75.us-east-2.compute.internal:4040/jobs/job?id=1","http://ip-10-0-0-75.us-east-2.compute.internal:4040/jobs/job?id=2","http://ip-10-0-0-75.us-east-2.compute.internal:4040/jobs/job?id=3","http://ip-10-0-0-75.us-east-2.compute.internal:4040/jobs/job?id=4"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1570199756720_1256123455","id":"20191004-143556_1355770434","dateCreated":"2019-10-04T14:35:56+0000","dateStarted":"2019-10-04T14:38:12+0000","dateFinished":"2019-10-04T14:38:21+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:13374"},{"text":"%sql\nSELECT word, count(1) AS count FROM (SELECT explode(split(line,' ')) AS word FROM docs) w GROUP BY word ORDER BY count DESC LIMIT 10","user":"anonymous","dateUpdated":"2019-10-04T14:34:48+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"word":"string","count":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1570199688362_1162359319","id":"20191004-001913_1847694692","dateCreated":"2019-10-04T14:34:48+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:13375"},{"text":"%sh hdfs dfs -ls /user/admin/datasets/gutenber-small/","user":"anonymous","dateUpdated":"2019-10-04T14:34:48+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1570199688362_-1498610151","id":"20191004-002222_1830120462","dateCreated":"2019-10-04T14:34:48+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:13376"},{"text":"%pyspark\ndf=spark.read.csv(\"s3://emontoyapublic/datasets/airlines.csv\", inferSchema=True, header=True)\ndf.show(10)\n","user":"anonymous","dateUpdated":"2019-10-04T14:45:09+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-10-0-0-75.us-east-2.compute.internal:4040/jobs/job?id=5","http://ip-10-0-0-75.us-east-2.compute.internal:4040/jobs/job?id=6","http://ip-10-0-0-75.us-east-2.compute.internal:4040/jobs/job?id=7"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1570199688363_1297459558","id":"20191004-002358_1006821055","dateCreated":"2019-10-04T14:34:48+0000","dateStarted":"2019-10-04T14:45:09+0000","dateFinished":"2019-10-04T14:45:19+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:13377"},{"text":"%pyspark\ndf.createOrReplaceTempView(\"airlines_db\")\nsqlDF = spark.sql(\"SELECT * FROM airlines_db\")\nsqlDF.show()","user":"anonymous","dateUpdated":"2019-10-04T14:45:56+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-10-0-0-75.us-east-2.compute.internal:4040/jobs/job?id=8"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1570200309937_747705697","id":"20191004-144509_155971254","dateCreated":"2019-10-04T14:45:09+0000","dateStarted":"2019-10-04T14:45:56+0000","dateFinished":"2019-10-04T14:45:57+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:13378"},{"text":"%sql\nSELECT * FROM airlines_db LIMIT 10\n","user":"anonymous","dateUpdated":"2019-10-04T14:46:27+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"id":"string","airline":"string","date":"string","location":"string","rating":"string","cabin":"string","value":"string","recommended":"string","review":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-10-0-0-75.us-east-2.compute.internal:4040/jobs/job?id=9"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1570200356142_1911732705","id":"20191004-144556_1177080435","dateCreated":"2019-10-04T14:45:56+0000","dateStarted":"2019-10-04T14:46:26+0000","dateFinished":"2019-10-04T14:46:26+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:13379"},{"text":"%pyspark\n\nimport nltk\nimport pandas as pd\nimport numpy as np\nimport re\nimport codecs\nimport matplotlib.pyplot as plt\n","user":"anonymous","dateUpdated":"2019-10-04T14:47:45+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1570200386125_1918182720","id":"20191004-144626_1425468394","dateCreated":"2019-10-04T14:46:26+0000","dateStarted":"2019-10-04T14:47:45+0000","dateFinished":"2019-10-04T14:47:45+0000","status":"ERROR","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:13380"},{"text":"%sh\npip install nltk --user\n","user":"anonymous","dateUpdated":"2019-10-04T14:48:17+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1570200465367_881015937","id":"20191004-144745_628415646","dateCreated":"2019-10-04T14:47:45+0000","dateStarted":"2019-10-04T14:48:17+0000","dateFinished":"2019-10-04T14:48:20+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:13381"}],"name":"zeppelin-demo","id":"2ERAGYE2T","noteParams":{},"noteForms":{},"angularObjects":{"sh:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}